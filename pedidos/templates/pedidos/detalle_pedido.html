{% extends "base.html" %}

{% block title %}{{ titulo }}{% endblock %}

{% block content %}
<h1 style="color: #6C5CE7; margin-bottom: 20px;">
    üìã Detalle de Pedido #{{ pedido.idPedido }}
</h1>

<div style="margin-bottom: 20px;">
    <a href="{% url 'pedidos:listar_pedidos' %}" class="btn btn-secondary" style="background-color: #6c757d; color: white; padding: 8px 15px; text-decoration: none; border-radius: 5px;">
        ‚Üê Volver a Listado de Pedidos
    </a>
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
    <!-- Informaci√≥n General del Pedido -->
    <div style="background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
        <h3 style="font-weight: bold; color: #343a40; margin-bottom: 15px;">Informaci√≥n General</h3>
        <p><strong>Cliente:</strong> {{ pedido.idCliente.nombre }}</p>
        <p><strong>Fecha:</strong> {{ pedido.fecha|date:"Y-m-d H:i" }}</p>
        <p><strong>Creado por:</strong> {{ pedido.creado_por.nombre|default:"N/A" }}</p>
        <p><strong>Estado:</strong> <span style="font-weight: bold; color: {% if pedido.estado == 'PENDIENTE' %}#ffc107{% elif pedido.estado == 'PAGADO' %}#28a745{% elif pedido.estado == 'CANCELADO' %}#dc3545{% else %}#007bff{% endif %};">{{ pedido.estado }}</span></p>
    </div>

    <!-- Resumen Financiero -->
    <div style="background-color: #e6f7ff; border: 1px solid #b3e0ff; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
        <h3 style="font-weight: bold; color: #0056b3; margin-bottom: 15px;">Resumen Financiero</h3>
        <p><strong>Total Pedido:</strong> <span style="font-size: 1.1em; font-weight: bold;">${{ pedido.total|floatformat:2 }}</span></p>
        <p><strong>Abono Acumulado:</strong> <span style="color: #28a745;">${{ pedido.abono_acumulado|floatformat:2 }}</span></p>
        

            <p><strong>Saldo Pendiente:</strong> <span style="font-weight: bold; color: {% if saldo_pendiente > 0 %}#dc3545{% else %}#28a745{% endif %};">${{ pedido.saldo_pendiente|floatformat:2 }}</span></p>

    </div>

    <!-- Notas del Pedido -->
    <div style="background-color: #fff3e0; border: 1px solid #ffe0b2; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
        <h3 style="font-weight: bold; color: #e65100; margin-bottom: 15px;">Notas</h3>
        <p>{{ pedido.notas|default:"No hay notas registradas para este pedido." }}</p>
    </div>
</div>

<h2 style="color: #6C5CE7; margin-top: 30px; margin-bottom: 15px;">Detalle de Art√≠culos</h2>

<table border="1" style="width: 100%; border-collapse: collapse; margin-top: 10px; font-family: 'Arial', sans-serif; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
    <thead>
        <tr style="background-color: #6C5CE7; color: white;">
            <th style="padding: 12px; width: 40%; text-align: left;">Uniforme (Escuela)</th>
            <th style="padding: 12px; width: 15%;">Talla</th>
            <th style="padding: 12px; width: 15%; text-align: right;">Precio Unitario</th>
            <th style="padding: 12px; width: 10%; text-align: center;">Cantidad</th>
            <th style="padding: 12px; width: 20%; text-align: right;">Subtotal</th>
        </tr>
    </thead>
    <tbody>
        {% for detalle in detalles %}
        <tr style="border-bottom: 1px solid #ddd; background-color: {% cycle '#f9f9f9' '#ffffff' %};">
            <td style="padding: 10px; text-align: left;">
                <span style="font-weight: bold;">{{ detalle.idVariante.idUniforme.nombre }}</span>
                <span style="color: #6c757d; font-size: 0.9em;">({{ detalle.idVariante.idUniforme.idEscuela.nombre }})</span>
            </td>
            <td style="padding: 10px; text-align: center;">{{ detalle.idVariante.talla }}</td>
            <td style="padding: 10px; text-align: right;">${{ detalle.precio_unitario|floatformat:2 }}</td>
            <td style="padding: 10px; text-align: center;">{{ detalle.cantidad }}</td>
            <td style="padding: 10px; text-align: right; font-weight: bold;">${{ detalle.subtotal|floatformat:2 }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" style="padding: 20px; text-align: center; color: #6c757d;">No hay art√≠culos en el detalle de este pedido.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}